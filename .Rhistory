data(mite)
data(mite.env)
data(mite.xy)
X <- data.frame(mite.xy, SubsDens = mite.env$SubsDens, mite)
library(vegan)
library(lme4)
library(tidyr)
library(ggplot2)
library(mgcv)
data(mite)
data(mite.env)
data(mite.xy)
X <- data.frame(mite.xy, SubsDens = mite.env$SubsDens, mite)
head(mite)
mite.long <- gather(data=X, species=colnames(mite), factor_key=TRUE)
names(mite.long)[4:5] <- c("species","N")
head(mite.long)
mite.long$SubsDens <- scale(mite.long$SubsDens )
m.lin <- glmer(N ~ SubsDens + (1 + SubsDens|species),
data=mite.long, family="poisson")
m.poly <- glmer(N ~ poly(SubsDens,degree=2) + (1 + poly(SubsDens, degree=2)|species),
data=mite.long, family="poisson")
preds <- data.frame(mite.long, preds=predict(m.poly, type="response"))
ggplot(data=preds, aes(x=SubsDens, y=N)) +
geom_point(aes(colour=species)) +
geom_line( aes(x=SubsDens, y=preds, colour=species) ) +
ylim(c(0,100))
library(vegan)
library(lme4)
library(tidyr)
library(ggplot2)
x <- seq(0,1, by=0.01)
x
plot(x,y)
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48,50,50)] <- c(5, 10, 5)
plot(x,y)
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48,50,52)] <- c(5, 10, 5)
plot(x,y)
m1 <- glm(y~poly(x,2), family="poisson")
lines(x, predict(m1, type="response"))
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48:52)] <- c(2, 7, 10, 5, 1)
plot(x,y)
m1 <- glm(y~poly(x,2), family="poisson")
lines(x, predict(m1, type="response"))
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48:52)] <- c(5, 7, 10, 5, 1)
plot(x,y)
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48:52)] <- c(5, 7, 10, 5, 1)
plot(x,y)
m1 <- glm(y~poly(x,2), family="poisson")
lines(x, predict(m1, type="response"))
x <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48:52)] <- c(5, 7, 10, 5, 1)
plot(x,y)
m1 <- glm(y~poly(x,2), family="poisson")
lines(x, predict(m1, type="response"))
x <- seq(0, 1, by = 0.01)
y <- 2*x - 3*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 2*x - 3*(x^2)
plot(x, exp(y))
x <- seq(0, 1, by = 0.01)
y <- 2*x - 3*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 2*x - 4*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 5*x - 4*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 4*x - 4*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 5*x - 5*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 5*x - 7*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 2*x - 2*(x^2)
plot(x, y)
x <- seq(0, 1, by = 0.01)
y <- 2*x - 2*(x^2)
plot(x, exp(y))
x <- seq(-2, 2, by = 0.1)
y <- 2*x - 2*(x^2)
plot(x, exp(y))
x <- seq(-2, 2, by = 0.1)
y <- x - x^2
plot(x, exp(y))
x <- seq(-2, 2, by = 0.1)
y <- x - x^2
plot(x, exp(y), type="l")
x <- seq(-2, 2, by = 0.1)
y <- 2*x - 2*x^2
plot(x, exp(y), type="l")
x <- seq(-2, 2, by = 0.1)
y <- 2*x - 3*x^2
plot(x, exp(y), type="l")
x <- seq(-2, 2, by = 0.1)
y <- 2*x - 4*x^2
plot(x, exp(y), type="l")
Humidity <- seq(-2, 2, by = 0.1)
y <- 2*Humidity - 4*x^2
plot(Humidity, exp(y), type="l")
Humidity <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(x))
y[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Humidity,y)
Humidity <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(Humidity))
y[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Humidity,y)
m1 <- glm(y~poly(x,2), family="poisson")
plot(x,y)
lines(x, predict(m1, type="response"))
Humidity <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(Humidity))
y[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Humidity,y)
m1 <- glm(y~poly(x,2), family="poisson")
plot(x,y)
lines(x, predict(m1, type="response"))
Humidity <- seq(-2, 2, by = 0.1)
Abundance <- 2*Humidity - 4*(Humidity^2)
plot(Humidity, exp(Abundance), type="l")
Humidity <- seq(0, 1, by = 0.01)
y <- rep(0, times = length(Humidity))
y[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Humidity,y)
m1 <- glm(Abundance~poly(Humidity,2), family="poisson")
plot(Humidity, Abundance)
lines(Humidity, predict(m1, type="response"))
Humidity <- seq(-2, 2, by = 0.1)
Abundance <- 2*Humidity - 4*(Humidity^2)
plot(Humidity, exp(Abundance), type="l")
Humidity <- seq(0, 1, by = 0.01)
Abundance <- rep(0, times = length(Humidity))
Abundance[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Humidity,Abundance)
m1 <- glm(Abundance~poly(Humidity,2), family="poisson")
plot(Humidity, Abundance)
lines(Humidity, predict(m1, type="response"))
Env <- seq(-2, 2, by = 0.1)
Abund <- 2*Env - 4*(Env^2)
plot(Env, exp(Abund), type="l")
Env <- seq(-2, 2, by = 0.1)
log.Abund <- 2*Env - 4*(Env^2)
plot(Env, exp(Abund), type="l")
Env <- seq(-2, 2, by = 0.1)
log.Abund <- 2*Env - 4*(Env^2)
plot(Env, exp(log.Abund), type="l")
Env <- seq(0, 1, by = 0.01)
Abund <- rep(0, times = length(Env))
Abund[c(48:52)] <- c(5, 7, 9, 5, 1)
plot(Env,Abund)
Env <- seq(-2, 2, by = 0.1)
log.Abund <- 2*Env - 4*(Env^2)
par(mfrow=c(1,2))
plot(Env, log.Abund, type="l")
plot(Env, exp(log.Abund), type="l")
Env <- seq(-2, 2, by = 0.1)
log_Abund <- 2*Env - 4*(Env^2)
par(mfrow=c(1,2))
plot(Env, log_Abund, type="l")
plot(Env, exp(log_Abund), type="l")
Env <- seq(-2, 2, by = 0.1)
log_Abund <- 2*Env - 4*(Env^2)
par(mfrow=c(1,2))
plot(Env, log_Abund, type="l", main="Abundance on a log scale")
plot(Env, exp(log_Abund), type="l", main="Abundance on a linear scale")
?poly
head(mite)
data(mite)
head(mite)
head(mite.long)
mite.long <- gather(data=X, species=colnames(mite), factor_key=TRUE)
names(mite.long)[4:5] <- c("species","N")
head(mite.long)
library(vegan)
library(lme4)
library(tidyr)
library(ggplot2)
data(mite)
data(mite.env)
data(mite.xy)
X <- data.frame(mite.xy, SubsDens = mite.env$SubsDens, mite)
head(X)
mite.long <- gather(data=X, species=colnames(mite), factor_key=TRUE)
names(mite.long)[4:5] <- c("species","N")
head(mite.long)
m.lin <- glmer(N ~ SubsDens + (1 + SubsDens|species),
data=mite.long, family="poisson")
m.poly <- glmer(N ~ poly(SubsDens,degree=2) + (1 + poly(SubsDens, degree=2)|species),
data=mite.long, family="poisson")
preds <- data.frame(mite.long, preds=predict(m.poly, type="response"))
ggplot(data=preds, aes(x=SubsDens, y=N)) +
geom_point(aes(colour=species)) +
geom_line( aes(x=SubsDens, y=preds, colour=species) ) +
ylim(c(0,100))
sessionInfo()
ggplot(data=preds, aes(x=SubsDens, y=log(N))) +
geom_point(aes(colour=species)) +
geom_line( aes(x=SubsDens, y=log(preds), colour=species) ) +
ylim(c(0,100))
ggplot(data=preds, aes(x=SubsDens, y=log(N))) +
geom_point(aes(colour=species)) +
geom_line( aes(x=SubsDens, y=log(preds), colour=species) )
